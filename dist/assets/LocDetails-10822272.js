import{u as w,s as N,o as r,c as i,F as T,r as b,a,t as u,b as W,d as k,e as g,f as y,g as A,h as x,i as C,_ as E,j as F,k as V,l as Y,w as j,m as K,L as M,n as m,p as H,A as P}from"./index-1bbcf9f0.js";const L={getUpdatesByLocationId:R,getUpdateByType:z},U="updatesDB";O();async function R(){return await N.get(U)}function v(e){return{type:e,updatedAt:Date.now()}}function z(e){return{weather:"You have checked the weather for this location at ",note:"You have updated your notes for this location at ",favorite:"you have added this location to your favorites at "}[e]||""}function O(){let e=w.loadFromStorage(U);return(!e||!e.length)&&(e=[{locId:"QovkC3",history:[v("weather"),v("note")]},{locId:"MDDddn",history:[v("note"),v("note")]}],w.saveToStorage(U,e)),e}const Q={class:"loc-updates"},q=a("h2",null,"Updates",-1),G={__name:"LocUpdates",props:{info:{type:Array}},setup(e){const c=e;function o(s){return L.getUpdateByType(s)}function n(s){return w.getFormattedTime(s)}return(s,t)=>(r(),i("section",Q,[q,(r(!0),i(T,null,b(c.info,(d,h)=>(r(),i("ul",{key:h},[a("li",null,[a("p",null,u(o(d.type)),1),a("p",null,[a("span",null,u(n(d.updatedAt).date),1),W(" | "),a("span",null,u(n(d.updatedAt).time),1)])])]))),128))]))}},J={class:"loc-notes"},X=a("h2",null,"Location Notes",-1),Z={__name:"LocNotes",props:{info:{type:String}},emits:["update-info"],setup(e,{emit:c}){const o=c,n=e;k(()=>{});function s(t){t.target.innerText,console.log("text:",t.target.innerText),o("update-Info",{key:"note",value:t.target.innerText})}return(t,d)=>(r(),i("section",J,[X,a("p",{contenteditable:"true",onBlur:s},u(n.info),33)]))}},ee="dae5f4bdc5e8ca68c1090b0be2429cfb";async function te({lat:e,lng:c}){const n=await(await fetch(`http://api.openweathermap.org/data/2.5/weather?lat=${e}&lon=${c}&APPID=${ee}`)).json();return{temp:ae(n.main.temp),name:n.name,humidity:n.main.humidity+"%",desc:n.weather[0].description,windSpeed:n.wind.speed+" Knots"}}function ae(e){return(e-273.15).toFixed(0)+"Â°C"}const oe={getWeatherByLocation:te},ne={key:0,class:"loc-weather"},se=a("h2",null,"Location Weather",-1),ce={__name:"LocWeather",props:{info:{type:Object}},setup(e){const c=e,o=g(null);async function n(){o.value=await oe.getWeatherByLocation(c.info)}return k(()=>{n()}),(s,t)=>o.value?(r(),i("section",ne,[se,a("h4",null,"Location name: "+u(o.value.name),1),a("p",null,"Temperature "+u(o.value.temp)+" - "+u(o.value.dec),1),a("p",null,"Humidity: "+u(o.value.humidity),1),a("p",null,"Wind Speed: "+u(o.value.windSpeed),1)])):y("",!0)}},le=A("update",()=>{const e=g(null),c=x(()=>e.value);async function o(s){e.value=await L.getUpdatesByLocationId(s)}async function n(s){const t=await L.addUpdate(s);e.value.push(t),C("Location removed")}return{addUpdate:n,loadUpdates:o,getUpdates:c}});const re={key:0,class:"loc-details"},ue=["src"],ie={class:"tab-list"},de=["onClick"],pe={class:"dynamic-container"},_e={__name:"LocDetails",setup(e){const c=F(),o=le(),n=V(),s=["Notes","Updates","Weather"];k(()=>{d(),B()});const t=g(null);async function d(){t.value=await Y.getLocById(n.params.locId)}const h=x(()=>{var l;return(l=o.getUpdates)==null?void 0:l.history});async function B(){f.value=await o.loadUpdates(n.params.locId)}const p=g("Notes");j(()=>console.log("currentTab:",p.value),console.log("updates:",h.value));function I(l){p.value=l}async function f({key:l,value:S}){const _={_id:t.value._id,key:l,value:S};t.value=await c.updateLoc(_)}function D(l){l.target.innerText,console.log("text:",l.target.innerText),f({key:"name",value:l.target.innerText})}return(l,S)=>t.value?(r(),i("div",re,[a("h3",{contenteditable:"true",onBlur:D},u(t.value.name),33),a("img",{src:t.value.imgUrl,height:"400",alt:"Location Image"},null,8,ue),K(M,{labels:t.value.labels},null,8,["labels"]),a("div",null,[a("div",ie,[(r(),i(T,null,b(s,(_,$)=>a("button",{key:$,class:H(["tab-button",{active:p.value===_}]),onClick:he=>I(_)},"Show "+u(_),11,de)),64))]),a("div",pe,[p.value==="Notes"?(r(),m(Z,{key:0,onUpdateInfo:f,info:t.value.note},null,8,["info"])):y("",!0),p.value==="Updates"?(r(),m(G,{key:1,info:h.value,onUpdateInfo:f},null,8,["info"])):y("",!0),p.value==="Weather"?(r(),m(ce,{key:2,info:{lat:t.value.lat,lng:t.value.lng}},null,8,["info"])):y("",!0)])])])):(r(),m(P,{key:1}))}},me=E(_e,[["__scopeId","data-v-d9772f53"]]);export{me as default};
